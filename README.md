# Phaser オートバトル RPG

PhaserとTypeScriptを使用したオートバトルRPGゲームプロジェクトです。

## 環境構築

### 必要条件

- Node.js (v14以上推奨)
- npm または yarn

### インストール

```bash
# リポジトリをクローン
git clone https://github.com/ishihara1989/js-game-sample.git
cd js-game-sample

# 依存パッケージをインストール
npm install
# または
yarn install
```

## 開発サーバーの起動

```bash
npm start
# または
yarn start
```

ブラウザで http://localhost:8080 を開いてゲームを確認できます。

## ビルド方法

開発が完了し、プロジェクトを本番環境にデプロイする準備ができたら、以下のコマンドでビルドを実行します：

```bash
npm run build
# または
yarn build
```

ビルドが成功すると、`dist` ディレクトリに最適化されたファイルが生成されます。これらのファイルは任意のウェブサーバーにデプロイできます。

### ビルド出力の確認方法

ビルド後の出力を確認するには、`dist` ディレクトリの内容を任意のウェブサーバーでホストするか、以下のようなシンプルなHTTPサーバーを使用します：

```bash
# グローバルにhttpサーバーをインストール
npm install -g http-server

# distディレクトリでサーバーを起動
cd dist
http-server -o
```

または、ローカルで実行するならPythonの組み込みサーバーも利用できます：

```bash
# Python 3の場合
cd dist
python -m http.server
```

ブラウザで http://localhost:8000 を開くと、ビルドされたアプリケーションが表示されます。

## 動作確認の手順

1. `npm start` でローカル開発サーバーを起動します
2. ブラウザで http://localhost:8080 を開きます
3. メインメニューが表示されたら「BATTLE START」ボタンをクリックします
4. バトル画面に遷移し、キャラクターが自動的に戦闘を行います
5. 勝敗が決まるとリザルト画面に遷移します

## ゲームシステム

### バトルの流れ

1. メイン画面の「BATTLE START」ボタンを押すと戦闘が開始されます
2. プレイヤーユニットと敵ユニットが自動的に移動し、攻撃を行います
3. 各ユニットは一定時間ごとに通常攻撃を行います
4. スキルゲージが満タンになるとスキルを使用します（通常攻撃より強力）
5. どちらかのHPが0になると戦闘終了となります
6. 勝利/敗北に応じたリザルト画面が表示されます

### ユニットの挙動

- **移動**: ユニットは戦闘中、ランダムな位置に移動します
- **通常攻撃**: 攻撃範囲内にターゲットがいると通常攻撃を行います
- **スキル**: スキルゲージが100%に達するとスキルを使用します
- **HP表示**: 各ユニットの上部にHPバーが表示されます
- **スキルゲージ**: HPバーの下にスキルゲージが表示されます

### 戦闘リザルト

- **勝利時**: 経験値、ゴールド、アイテムを獲得します
- **敗北時**: 「DEFEAT...」が表示されます
- どちらの場合も「CONTINUE」ボタンでメインメニューに戻ります

## トラブルシューティング

### 「npm start」でエラーが発生する場合

以下の手順を試してみてください：

1. プロジェクトフォルダで `npm install` を再実行して依存パッケージが正しくインストールされているか確認
2. Node.jsとnpmが最新バージョンになっているか確認（`node -v` と `npm -v` で確認可能）
3. 開発ポート（8080）が他のアプリケーションで使われていないか確認

### ブラウザで表示されない場合

- コンソールを確認してエラーメッセージを確認してください
- ブラウザのキャッシュをクリアしてみてください
- 別のブラウザで試してみてください（Chrome推奨）

## プロジェクト構成

```
├── src/                  # ソースコード
│   ├── assets/           # ゲームアセット（画像、音声など）
│   ├── scenes/           # Phaserのシーン
│   │   ├── MainScene.ts   # メインメニュー画面
│   │   ├── BattleScene.ts # 戦闘画面
│   │   └── ResultScene.ts # 戦闘結果画面
│   ├── objects/          # ゲームオブジェクト
│   │   └── Unit.ts        # ユニット（プレイヤー・敵）クラス
│   ├── types/            # 型定義
│   │   └── BattleTypes.ts # 戦闘関連の型定義
│   └── index.ts          # エントリーポイント
├── public/               # 静的ファイル
│   └── index.html        # HTMLテンプレート
├── dist/                 # ビルド出力ディレクトリ
├── webpack.config.js     # Webpackの設定
├── tsconfig.json         # TypeScriptの設定
├── package.json          # プロジェクト依存関係
├── .gitignore            # Git管理対象外ファイルの設定
└── README.md             # プロジェクト説明
```

## 主要な技術

- [Phaser 3](https://phaser.io/phaser3) - HTML5ゲームフレームワーク
- [TypeScript](https://www.typescriptlang.org/) - 型付きJavaScript
- [Webpack](https://webpack.js.org/) - モジュールバンドラー

## 開発について

### オートバトルシステム

このRPGは自動で進行するバトルシステムを採用しています。ユニットは自動的に移動・攻撃・スキル使用を行います。現在のバージョンでは1体対1体の戦闘ですが、将来的には複数ユニットでの戦闘に拡張予定です。

### バトルの仕様

- **攻撃クールダウン**: 攻撃後は一定時間（1.5秒）待機します
- **移動クールダウン**: 移動後は一定時間（0.5秒）待機します
- **スキルチャージ**: 時間経過でゆっくりと蓄積され、100%になると使用可能になります
- **ダメージ計算**: 攻撃力から防御力の一部を差し引いた値がダメージとなります
- **スキルダメージ**: 通常攻撃の約2倍のダメージを与えます

### 今後の実装予定

- 複数ユニットでの戦闘
- キャラクター作成・カスタマイズシステム
- 装備とインベントリ管理
- より複雑な戦闘アニメーション
- 高度な敵AIシステム
- レベルアップと成長システム
- ステージ選択システム

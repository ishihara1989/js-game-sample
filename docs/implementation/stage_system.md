# ステージシステムの実装状況

## 概要

ステージシステムは、戦闘シーンから敵の生成と管理をより体系的に管理するために実装されました。
このシステムにより、さまざまなステージごとに背景、敵の構成、難易度設定を個別に行うことが可能になっています。

## 実装済み機能

### 基本構造

- **Stage 基底クラス**
  - ステージの基本的な構造と振る舞いを定義
  - 背景設定と描画
  - 敵の生成・配置管理
  - ステージ進行状態の管理（WAVE制）
  - イベントシステム（ステージ開始、敵出現、ステージクリアなど）

- **StageFactory**
  - ステージIDに基づいて適切なステージインスタンスを生成
  - ステージの解放状態の管理
  - プレイヤーの進行状況に応じたステージアンロック

### ステージバリエーション

現在、以下のステージが実装されています：

1. **Stage_1_1 (ゴブリンの森 1)**
   - 最初のステージ
   - 少数の弱い敵が出現
   - プレイヤーのチュートリアルとしての役割

2. **Stage_1_2 (ゴブリンの森 2)**
   - 中級難易度のステージ
   - 複数のWAVEで敵が出現
   - 前半は弱い敵、後半はより強い敵

3. **Stage_1_3 (ゴブリンの森 3)**
   - 高難易度ステージ
   - 複数のWAVEと多数の敵
   - 最終WAVEにはミニボスが登場

### バトルシーンとの連携

- BattleSceneクラスがステージシステムを利用するよう改修
- 敵の直接生成から、ステージを介した間接的な生成方式に変更
- ステージイベントをBattleSceneが監視し適切に処理
- ステージクリア条件とリザルトシーンへの遷移を連携

## UI要素

- ステージ名の表示
- 現在のWAVE表示
- 敵の出現アニメーション
- 背景のパララックス効果
- UI要素の適切な描画深度設定

## 今後の課題

1. **より多様なステージの追加**
   - 異なる環境の背景（森、洞窟、砂漠など）
   - 特殊な地形効果（ダメージタイル、速度低下エリアなど）
   - より複雑なWAVE構成

2. **ボス戦の強化**
   - 専用ボスステージの追加
   - ボス固有のAIパターン
   - 特殊なボス戦演出

3. **ステージ選択UIの強化**
   - マップ表示によるステージ選択
   - ステージ詳細情報の表示（推奨レベル、ドロップアイテムなど）
   - ステージごとの目標・チャレンジ要素

4. **ステージリプレイ機能**
   - クリア済みステージの再挑戦
   - 難易度選択（EASY/NORMAL/HARD）
   - スコアシステムとランキング
